<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# session

```go
import "github.com/TrueHopolok/braincode-/server/session"
```

Implements:

- session can be encrypted into jwt for transfering
- contain functionality to work with expiration time
- contain functionality to key changing to secure the encryption

Package can be used in multithreads.

## Index

- [Constants](<#constants>)
- [func AuthMiddleware\(h http.Handler\) http.Handler](<#AuthMiddleware>)
- [func AuthMiddlewareFunc\(f http.HandlerFunc\) http.Handler](<#AuthMiddlewareFunc>)
- [func Login\(s Session, w http.ResponseWriter\)](<#Login>)
- [func Logout\(w http.ResponseWriter\)](<#Logout>)
- [func Middleware\(h http.Handler\) http.Handler](<#Middleware>)
- [func MiddlewareFunc\(f http.HandlerFunc\) http.Handler](<#MiddlewareFunc>)
- [func NoAuthMiddleware\(h http.Handler\) http.Handler](<#NoAuthMiddleware>)
- [func NoAuthMiddlewareFunc\(f http.HandlerFunc\) http.Handler](<#NoAuthMiddlewareFunc>)
- [func SetKey\(new\_cur\_key \[\]byte\) error](<#SetKey>)
- [func SwitchKey\(\)](<#SwitchKey>)
- [type Session](<#Session>)
  - [func Get\(ctx context.Context\) Session](<#Get>)
  - [func New\(name string\) Session](<#New>)
  - [func \(ses Session\) CreateJWT\(\) string](<#Session.CreateJWT>)
  - [func \(ses Session\) IsExpired\(\) bool](<#Session.IsExpired>)
  - [func \(ses Session\) IsZero\(\) bool](<#Session.IsZero>)
  - [func \(ses \*Session\) UpdateExpiration\(\)](<#Session.UpdateExpiration>)
  - [func \(ses \*Session\) ValidateJWT\(token string\) bool](<#Session.ValidateJWT>)


## Constants

<a name="AuthCookieName"></a>

```go
const AuthCookieName = "auth"
```

<a name="EXPIRATION_TIME"></a>Session expiration time messarued in hours

```go
const EXPIRATION_TIME = 1.0
```

<a name="AuthMiddleware"></a>
## func [AuthMiddleware](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/middleware.go#L68>)

```go
func AuthMiddleware(h http.Handler) http.Handler
```

AuthMiddleware wraps h making it reject all requests which are not authorized.

AuthMiddleware modifies the context of request, [Session](<#Session>) can be retrieved with [Get](<#Get>).

<a name="AuthMiddlewareFunc"></a>
## func [AuthMiddlewareFunc](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/middleware.go#L103>)

```go
func AuthMiddlewareFunc(f http.HandlerFunc) http.Handler
```

See [AuthMiddleware](<#AuthMiddleware>)

<a name="Login"></a>
## func [Login](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/session.go#L50>)

```go
func Login(s Session, w http.ResponseWriter)
```



<a name="Logout"></a>
## func [Logout](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/session.go#L63>)

```go
func Logout(w http.ResponseWriter)
```

Logout deletes the auth cookie. Caller is responsible for not using any remaining session values.

<a name="Middleware"></a>
## func [Middleware](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/middleware.go#L32>)

```go
func Middleware(h http.Handler) http.Handler
```

Middleware wraps h, making it parse and validate sessions.

If request is properly authenticated, [Get](<#Get>)\(r.Context\(\)\) will return a non\-zero [Session](<#Session>). Otherwise, session will be unset.

Prefer [AuthMiddleware](<#AuthMiddleware>) or [NoAuthMiddleware](<#NoAuthMiddleware>) if a resource is only available to authorized or unauthorized users. [Middleware](<#Middleware>) should only be used when handler has different behavior depending on authentication status.

<a name="MiddlewareFunc"></a>
## func [MiddlewareFunc](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/middleware.go#L61>)

```go
func MiddlewareFunc(f http.HandlerFunc) http.Handler
```

See [Middleware](<#Middleware>)

<a name="NoAuthMiddleware"></a>
## func [NoAuthMiddleware](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/middleware.go#L112>)

```go
func NoAuthMiddleware(h http.Handler) http.Handler
```

NoAuthMiddleware wraps h making it reject all requests which have authentication headers set.

NoAuthMiddleware deletes session from the context.

Note that requests with invalid Cookie headers will still be rejected.

<a name="NoAuthMiddlewareFunc"></a>
## func [NoAuthMiddlewareFunc](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/middleware.go#L143>)

```go
func NoAuthMiddlewareFunc(f http.HandlerFunc) http.Handler
```

See [NoAuthMiddleware](<#NoAuthMiddleware>)

<a name="SetKey"></a>
## func [SetKey](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/keys.go#L46>)

```go
func SetKey(new_cur_key []byte) error
```

\!WARN\! \- Use only for testing and debuging purposes

Updates keys:

- previous key become previously current key
- current key is set to a given key

<a name="SwitchKey"></a>
## func [SwitchKey](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/keys.go#L33>)

```go
func SwitchKey()
```

Updates keys:

- previous key become previously current key
- current key randomly generates

<a name="Session"></a>
## type [Session](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/session.go#L29-L32>)

Stores all info about session.

All fields can be accessed outside of a package. The methods only here as helpers implementation.

```go
type Session struct {
    Name   string    `json:"name"`
    Expire time.Time `json:"expire"`
}
```

<a name="Get"></a>
### func [Get](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/middleware.go#L17>)

```go
func Get(ctx context.Context) Session
```

Get retrieves value of session from ctx.

If no such value exists, returns a zero value [Session](<#Session>), which will satisfy [Session.IsZero](<#Session.IsZero>)

<a name="New"></a>
### func [New](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/session.go#L34>)

```go
func New(name string) Session
```



<a name="Session.CreateJWT"></a>
### func \(Session\) [CreateJWT](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/jwt.go#L32>)

```go
func (ses Session) CreateJWT() string
```

Create jwt with information from provided session.

May panic if somehow JSON serialization or HMAC hash fail.

<a name="Session.IsExpired"></a>
### func \(Session\) [IsExpired](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/session.go#L42>)

```go
func (ses Session) IsExpired() bool
```



<a name="Session.IsZero"></a>
### func \(Session\) [IsZero](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/session.go#L46>)

```go
func (ses Session) IsZero() bool
```



<a name="Session.UpdateExpiration"></a>
### func \(\*Session\) [UpdateExpiration](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/session.go#L38>)

```go
func (ses *Session) UpdateExpiration()
```



<a name="Session.ValidateJWT"></a>
### func \(\*Session\) [ValidateJWT](<https://github.com/TrueHopolok/braincode-/blob/main/server/session/jwt.go#L48>)

```go
func (ses *Session) ValidateJWT(token string) bool
```

ValidateJWT parses given token into ses, reporting whether token is valid.

May panic if token was create on a different version or given a different JSON schema.

Receiver is unchanged in case token is invalid.

This function is safe to use with user input.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
