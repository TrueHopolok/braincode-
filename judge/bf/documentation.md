<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# bf

```go
import "github.com/TrueHopolok/braincode-/judge/bf"
```

Package bf implements a brainfunk interpreter

Brainfunk needs to be compiled into byte code using [Compile](<#Compile>) and then executed using [State](<#State>).

## Index

- [type ByteCode](<#ByteCode>)
  - [func Compile\(source string, instructionLimit int\) \(ByteCode, error\)](<#Compile>)
  - [func \(bc ByteCode\) AppendBinary\(b \[\]byte\) \(\[\]byte, error\)](<#ByteCode.AppendBinary>)
  - [func \(bc \*ByteCode\) AppendText\(b \[\]byte\) \(\[\]byte, error\)](<#ByteCode.AppendText>)
  - [func \(bc ByteCode\) MarshalBinary\(\) \(\[\]byte, error\)](<#ByteCode.MarshalBinary>)
  - [func \(bc \*ByteCode\) MarshalText\(\) \(text \[\]byte, err error\)](<#ByteCode.MarshalText>)
  - [func \(b ByteCode\) String\(\) string](<#ByteCode.String>)
  - [func \(bc \*ByteCode\) UnmarshalBinary\(data \[\]byte\) error](<#ByteCode.UnmarshalBinary>)
  - [func \(bc \*ByteCode\) UnmarshalText\(text \[\]byte\) error](<#ByteCode.UnmarshalText>)
- [type CompilationError](<#CompilationError>)
  - [func \(e CompilationError\) Error\(\) string](<#CompilationError.Error>)
- [type CompilationErrorKind](<#CompilationErrorKind>)
- [type Op](<#Op>)
- [type RuntimeError](<#RuntimeError>)
  - [func \(e RuntimeError\) Error\(\) string](<#RuntimeError.Error>)
- [type State](<#State>)
  - [func NewState\(code ByteCode, r io.Reader, w io.Writer, stepLimit int, memoryLimit int\) State](<#NewState>)
  - [func \(s \*State\) Error\(\) error](<#State.Error>)
  - [func \(s \*State\) Finished\(\) bool](<#State.Finished>)
  - [func \(s \*State\) RemainingSteps\(\) int](<#State.RemainingSteps>)
  - [func \(s \*State\) Run\(\) error](<#State.Run>)
  - [func \(s \*State\) Step\(\) error](<#State.Step>)
  - [func \(s \*State\) UsedMemory\(\) int](<#State.UsedMemory>)


<a name="ByteCode"></a>
## type [ByteCode](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/compile.go#L10-L12>)

ByteCode contains a compiled brainfunk program.

ByteCode is immutable, so it is safe to use from multiple goroutines.

```go
type ByteCode struct {
    // contains filtered or unexported fields
}
```

<a name="Compile"></a>
### func [Compile](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/compile.go#L74>)

```go
func Compile(source string, instructionLimit int) (ByteCode, error)
```

Compile extracts byte code from a source string.

Initial comment loop will be stripped.

Instruction limit may be set to limit length of byte code. Negative limit disables it. In that case, [CompilationError](<#CompilationError>) with kind [CompilationInstructionLimit](<#CompilationUnmatchedParen>) is never returned.

Returned error's underlying type is [CompilationError](<#CompilationError>).

<a name="ByteCode.AppendBinary"></a>
### func \(ByteCode\) [AppendBinary](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/serialize.go#L18>)

```go
func (bc ByteCode) AppendBinary(b []byte) ([]byte, error)
```

MarshalBinary packs byte code into the provided byte slice. This is around 2.5 time more space efficient then storing result of [ByteCode.String](<#ByteCode.String>).

Implements [encoding.BinaryAppender](<https://pkg.go.dev/encoding/#BinaryAppender>).

<a name="ByteCode.AppendText"></a>
### func \(\*ByteCode\) [AppendText](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/serialize.go#L103>)

```go
func (bc *ByteCode) AppendText(b []byte) ([]byte, error)
```

AppendText appends valid brainfunk source to b. It will never error.

Implements [encoding.TextAppender](<https://pkg.go.dev/encoding/#TextAppender>).

<a name="ByteCode.MarshalBinary"></a>
### func \(ByteCode\) [MarshalBinary](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/serialize.go#L12>)

```go
func (bc ByteCode) MarshalBinary() ([]byte, error)
```

MarshalBinary packs byte code into a byte slice. This is around 2.5 time more space efficient then storing result of [ByteCode.String](<#ByteCode.String>).

Implements [encoding.BinaryMarshaler](<https://pkg.go.dev/encoding/#BinaryMarshaler>).

<a name="ByteCode.MarshalText"></a>
### func \(\*ByteCode\) [MarshalText](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/serialize.go#L96>)

```go
func (bc *ByteCode) MarshalText() (text []byte, err error)
```

MarshalText emits a valid brainfunk source. It will never error.

Implements [encoding.TextMarshaler](<https://pkg.go.dev/encoding/#TextMarshaler>).

<a name="ByteCode.String"></a>
### func \(ByteCode\) [String](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/serialize.go#L142>)

```go
func (b ByteCode) String() string
```

String returns a human readable \(relatively\) representation of the byte code. Returned bytecode is always a valid brainfunk program, that is

```
Compile(b.String())
```

will never error.

<a name="ByteCode.UnmarshalBinary"></a>
### func \(\*ByteCode\) [UnmarshalBinary](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/serialize.go#L44>)

```go
func (bc *ByteCode) UnmarshalBinary(data []byte) error
```

UnmarshalBinary decodes data generated by [ByteCode.MarshalBinary](<#ByteCode.MarshalBinary>) or [ByteCode.UnmarshalBinary](<#ByteCode.UnmarshalBinary>)

Implements [encoding.BinaryUnmarshaler](<https://pkg.go.dev/encoding/#BinaryUnmarshaler>).

<a name="ByteCode.UnmarshalText"></a>
### func \(\*ByteCode\) [UnmarshalText](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/serialize.go#L127>)

```go
func (bc *ByteCode) UnmarshalText(text []byte) error
```

UnmarshalText runs [Compile](<#Compile>).

Implements [encoding.TextUnmarshaler](<https://pkg.go.dev/encoding/#TextUnmarshaler>).

<a name="CompilationError"></a>
## type [CompilationError](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/error.go#L6-L11>)

CompilationError is used to report a compilation error.

```go
type CompilationError struct {
    Kind CompilationErrorKind // Kind of error.

    Offset int  // Offending byte offset in the original source code.
    Char   rune // Offending rune. Will always fit into a byte.
}
```

<a name="CompilationError.Error"></a>
### func \(CompilationError\) [Error](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/error.go#L20>)

```go
func (e CompilationError) Error() string
```



<a name="CompilationErrorKind"></a>
## type [CompilationErrorKind](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/error.go#L13>)



```go
type CompilationErrorKind int
```

<a name="CompilationUnmatchedParen"></a>

```go
const (
    CompilationUnmatchedParen   CompilationErrorKind = iota // Loop brackets are not matched.
    CompilationInstructionLimit                             // Compiled program exceeds set limit.
)
```

<a name="Op"></a>
## type [Op](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/compile.go#L15>)

Op is a brainfunk operations.

```go
type Op byte
```

<a name="OpLeft"></a>

```go
const (
    OpLeft      Op  = '<' // Move head left. Underflow is a runtime error.
    OpRight     Op  = '>' // Move head right. May allocate another byte.
    OpIncrement Op  = '+' // Increment value under head. Wraps.
    OpDecrement Op  = '-' // Decrement value under head. Wraps.
    OpInput     Op  = ',' // Copy byte from input to head.
    OpOutput    Op  = '.' // Copy byte from head to output.
    OpLoopStart Op  = '[' // Start of loop. Loop acts as a while (head != 0) loop.
    OpLoopEnd   Op  = ']' // End of loop.

)
```

<a name="RuntimeError"></a>
## type [RuntimeError](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/error.go#L32>)

RuntimeError is used to report a failure during execution of a brainfunk program.

```go
type RuntimeError int
```

<a name="RuntimeErrorHeadUnderflow"></a>

```go
const (
    RuntimeErrorHeadUnderflow RuntimeError = iota // Head executed [OpLeft] while pointing to leftmost byte.
    RuntimeErrorMemoryLimit                       // Program allocated limit+1 bytes.
    RuntimeErrorStepLimit                         // Program did not terminate after limit steps.
)
```

<a name="RuntimeError.Error"></a>
### func \(RuntimeError\) [Error](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/error.go#L40>)

```go
func (e RuntimeError) Error() string
```



<a name="State"></a>
## type [State](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/run.go#L19-L32>)

State stores runtime brainfunk state.

Zero value for state is a terminated program.

State is \*not\* safe for concurrent use.

```go
type State struct {
    // contains filtered or unexported fields
}
```

<a name="NewState"></a>
### func [NewState](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/run.go#L45-L51>)

```go
func NewState(code ByteCode, r io.Reader, w io.Writer, stepLimit int, memoryLimit int) State
```

NewState creates a new [State](<#State>).

r is used for standard input. It may be nil, in that case program will fail with EOF on first read. If r implements [io.ByteReader](<https://pkg.go.dev/io/#ByteReader>) it is used instead.

w is used for standard output. It may be nil, in that program will fail on first write. If w implements [io.ByteWriter](<https://pkg.go.dev/io/#ByteWriter>) it is used instead.

Step and memory limits must be set. Negative limits terminated the program immediately.

<a name="State.Error"></a>
### func \(\*State\) [Error](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/run.go#L113>)

```go
func (s *State) Error() error
```

Error returns an error if one has happened. If the program did not complete, Error returns a nil error.

<a name="State.Finished"></a>
### func \(\*State\) [Finished](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/run.go#L108>)

```go
func (s *State) Finished() bool
```

Finished reports whether program completed. All steps will be no\-ops after program finished.

<a name="State.RemainingSteps"></a>
### func \(\*State\) [RemainingSteps](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/run.go#L92>)

```go
func (s *State) RemainingSteps() int
```

RemainingSteps returns maximum number of steps program can take before hitting the step limit.

<a name="State.Run"></a>
### func \(\*State\) [Run](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/run.go#L101>)

```go
func (s *State) Run() error
```

Run steps repeatedly until program either runs to completion or returns an error.

\[Finished\] is guaranteed to return true after a call to Run.

See \[Step\] for more info.

<a name="State.Step"></a>
### func \(\*State\) [Step](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/run.go#L126>)

```go
func (s *State) Step() error
```

Step executes a single brainfunk instruction.

Error is returned in 2 cases:

- When a runtime error occurs, in that case underlying type will be [RuntimeError](<#RuntimeError>)
- If an IO operation fails, in that case error is passes as\-is from the reader or writer.

Calling Step on a finished state is a no\-op, it will return result of last call to Step.

Any error terminates the brainfunk program.

<a name="State.UsedMemory"></a>
### func \(\*State\) [UsedMemory](<https://github.com/TrueHopolok/braincode-/blob/main/judge/bf/run.go#L87>)

```go
func (s *State) UsedMemory() int
```

UsedMemory returns maximum number of bytes ever used by the program.

Only tape memory is considered, any input or output bytes are not. Byte code length is also not counted.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
